<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Twitch Streamer Widget</title>
</head>
<body>
	<script>
// HTML structure for the widget
const widgetHTML = `
  <div id="twitch-widget" style="border: 1px solid #ccc; padding: 20px; width: 300px; font-family: Arial, sans-serif;">
    <h3 id="streamer-name">Loading...</h3> <!-- Default loading text for streamer name -->
    <p id="max-viewers">Max Viewers: --</p> <!-- Placeholder for max viewers data -->
    <p id="followers">Followers: --</p> <!-- Placeholder for followers count -->
    <p id="time-streamed">Time Streamed: --</p> <!-- Placeholder for time streamed data -->
  </div>
`;

// Insert the widget's HTML into the body of the page
document.body.innerHTML = widgetHTML;

// Function to fetch TwitchTracker API data for a specific user
async function fetchTwitchData(username) {
  try {
    // Send a request to the TwitchTracker API endpoint for the given username
    const response = await fetch(`https://twitchtracker.com/api/channels/summary/${username}`);

    // Check if the API response is successful
    if (!response.ok) {
      throw new Error('Error fetching data. Streamer may not exist.');
    }

    // Parse the JSON data returned by the API
    const data = await response.json();

    // Destructure the relevant fields from the API response
    const { max_viewers, followers, time_streamed } = data;

    // Update the widget content with the fetched data
    document.getElementById('streamer-name').textContent = `Streamer: ${username}`; // Update streamer name
    document.getElementById('max-viewers').textContent = `Max Viewers: ${max_viewers ?? 'N/A'}`; // Display max viewers or N/A if missing
    document.getElementById('followers').textContent = `Followers: ${followers ?? 'N/A'}`; // Display followers count or N/A if missing
    document.getElementById('time-streamed').textContent = `Time Streamed: ${time_streamed ?? 'N/A'}`; // Display time streamed or N/A if missing
  } catch (error) {
    // Handle any errors that occur during the fetch request
    document.getElementById('streamer-name').textContent = 'Error'; // Show error message in streamer name field
    document.getElementById('max-viewers').textContent = error.message; // Display error message
    document.getElementById('followers').textContent = ''; // Clear followers field
    document.getElementById('time-streamed').textContent = ''; // Clear time streamed field
  }
}

// Call the function to fetch data for a specific streamer
fetchTwitchData('geekfreak_');
	</script>
</body>
</html>
