<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Twitch Streamer Widget</title>
</head>
<body>
	<script>
// HTML structure for the widget
const widgetHTML = `
  <div id="twitch-widget" style="border: 1px solid #ccc; padding: 20px; width: 300px; font-family: Arial, sans-serif;">
    <h3 id="streamer-name">Loading...</h3>
    <p id="max-viewers">Max Viewers: --</p>
    <p id="followers">Followers: --</p>
    <p id="time-streamed">Time Streamed: --</p>
  </div>
`;

document.body.innerHTML = widgetHTML;

// Function to fetch Twitch data using the public client ID
async function fetchTwitchData(username) {
  try {
    const clientId = 'kimne78kx3ncx6brgo4mv6wki5h1ko'; // Public client ID used by many Twitch integrations

    // Fetching user data
    const userResponse = await fetch(`https://api.twitch.tv/helix/users?login=${username}`, {
      headers: {
        'Client-ID': clientId,
        'Authorization': 'Bearer anonymous', // Using anonymous bearer token
      },
    });

    if (!userResponse.ok) {
      throw new Error('Streamer not found');
    }

    const userData = await userResponse.json();
    const user = userData.data[0];

    // Fetching stream data
    const streamResponse = await fetch(`https://api.twitch.tv/helix/streams?user_id=${user.id}`, {
      headers: {
        'Client-ID': clientId,
        'Authorization': 'Bearer anonymous',
      },
    });

    const streamData = await streamResponse.json();
    const stream = streamData.data[0];

    // Updating the widget
    document.getElementById('streamer-name').textContent = user.display_name;
    document.getElementById('max-viewers').textContent = `Max Viewers: ${stream ? stream.viewer_count : 'Offline'}`;
    document.getElementById('followers').textContent = `Followers: ${user.view_count}`;
    document.getElementById('time-streamed').textContent = `Time Streamed: ${stream ? 'Currently streaming' : 'N/A'}`;
  } catch (error) {
    document.getElementById('streamer-name').textContent = 'Error';
    document.getElementById('max-viewers').textContent = error.message;
    document.getElementById('followers').textContent = '';
    document.getElementById('time-streamed').textContent = '';
  }
}

// Example usage
fetchTwitchData('geekfreak_');
	</script>
</body>
</html>
